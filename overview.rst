========
Overview
========

Grocery product recognition comes under the category of Instance Recognition. It has its own challenges. 

The potential applications of the project are

* Monitoring Retail stores
* Tracking stock availability
* Finding misplaced objects
* Misoriented objects

Challenges
----------

In this project we are trying to address the following challenges.

* Less training images
* Variations within classes
* Similarity between products
* Specularity due to lighting
* Occlusion
* Deformation
* Tiny and Cylindrical objects
* More than 1000 classes

Methods
-------
The problem can be approached in three different ways as follows.

* Feature Matching
	* Deformable Spatial Pyramid (DSP) [dsp]_
* Template Matching techniques
	* Template matching using HOG
	* Deep features in template matching
	* Part based template matching
* Deep Learning
	* Classification by finetuning (AlexNet, ZF, VGG-16)
	* Classification and Localization using fine tuning (Faster RCNN) [faster_rcnn]_

**Feature matching** techniques works well when the target image has only one instance of the search object. But in the retail case, there will be multiple instances placed together. Also, different products look very similar to each other. In these cases, the features are distributed among many instances. One approach that resolves this issue is Deformable Spatial Pyramid [dsp]_ technique that splits the images into grids and computes features in every grid and connects them together.

**Template matching** is well suited for the problem mainly because the scale is fixed and multiple instances can be easily recognized. The scale is known in advance because the robot always captures images from a constant distance. A simple sliding window matching can recognize multiple instances. The technique is extended to use part-based matching where each instance of a class is considered as a part. Part-based matching makes use of the prior information that same instances are found together. It ignores the false positives by searching the peaks together in the heatmap of template matching.

**Deep Learning** techiniques are explored to generalize the recognition across multiple classes. The idea is to use less of prior information and to learn from one example of training image. This will be scalable because in most cases only one studio front viewing image is available as training image in retail stores. Grocery product dataset [groc_dataset]_ has such training images. Faster RCNN [faster_rcnn]_ is used to do localization and recognition together.

Experiments
-----------
The experiments made with Bossa Nova dataset are confidential. We also validated our approaches on the standard Grocery Product Dataset [groc_dataset]_

The problem of object detection has various components in the pipeline.

* Training Images
* Object Proposal
* Classification

Data Augmentation
`````````````````
The main problem in dealing with Grocery products is the lack of training images. The Grocery Product dataset just has one studio image per class as training image. To enable deep learning, there is a need for data augmentation.

* Each training image is placed on a random background image with variations like - more/less brighness, more/less contrast.

Object Proposal
```````````````
In RCNN network, the object detection problem is addressed by relying on the region proposals. The network is trained to do regression of bounding boxes given the region proposal. Hence region proposals have huge impact on the detection results. Few region proposal methods that we analyzed are,

* Selective Search Region Proposal
* RPN - Region Proposal Network

Classification
``````````````
To finetune the overall performance of detection, the classification component is experiemted separately. 

500 training images per class were generated by the data augmentation step. After fine-tuning a deep network with VGG-16 architecture, the classification accuracy for top 5 classes are shown below.

138 Classes (In Food -> Cereals category)

+------+------+------+------+------+
| Top 1| Top 2| Top 3| Top 4| Top 5|
+======+======+======+======+======+
| 60.45| 68.63| 70.45| 70.90| 72.72|
+------+------+------+------+------+

Conclusion
----------
The problem of Instance Recognition is still in its early stage. In general, Advancements with Deep Learning works well only with large number of training images. In this project, we have explored three different approaches to tackle the problem - Feature Matching, Template Matching, and Deep Learning. Deep Learning approaches seems to perform better even with less training iamges and less prior information.




